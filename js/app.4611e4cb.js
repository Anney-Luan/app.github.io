(function(e){function t(t){for(var c,n,r=t[0],u=t[1],d=t[2],b=0,s=[];b<r.length;b++)n=r[b],Object.prototype.hasOwnProperty.call(l,n)&&l[n]&&s.push(l[n][0]),l[n]=0;for(c in u)Object.prototype.hasOwnProperty.call(u,c)&&(e[c]=u[c]);i&&i(t);while(s.length)s.shift()();return o.push.apply(o,d||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],c=!0,r=1;r<a.length;r++){var u=a[r];0!==l[u]&&(c=!1)}c&&(o.splice(t--,1),e=n(n.s=a[0]))}return e}var c={},l={app:0},o=[];function n(t){if(c[t])return c[t].exports;var a=c[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=c,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)n.d(a,c,function(t){return e[t]}.bind(null,c));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],u=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var i=u;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},4682:function(e,t,a){"use strict";a("c78b")},"56d7":function(e,t,a){"use strict";a.r(t);var c=a("7a23");function l(e,t,a,l,o,n){const r=Object(c["resolveComponent"])("HelloWorld");return Object(c["openBlock"])(),Object(c["createBlock"])(r,{msg:"Welcome to Your Vue.js App"})}const o={style:{display:"flex"}},n={style:{"margin-top":"20px"}},r={style:{"margin-top":"20px"}},u={style:{"margin-top":"20px"}},d={style:{"margin-top":"20px"}};function i(e,t,a,l,i,b){const s=Object(c["resolveComponent"])("el-tag"),p=Object(c["resolveComponent"])("el-button"),j=Object(c["resolveComponent"])("el-upload"),O=Object(c["resolveComponent"])("el-timeline-item"),f=Object(c["resolveComponent"])("el-timeline"),v=Object(c["resolveComponent"])("el-table-column"),h=Object(c["resolveComponent"])("el-table");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("div",o,[Object(c["createVNode"])(f,null,{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(O,null,{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",n,[Object(c["createVNode"])(s,{size:"large",type:"info"},{default:Object(c["withCtx"])(()=>t[1]||(t[1]=[Object(c["createTextVNode"])("第一步")])),_:1})]),Object(c["createVNode"])(j,{action:"","auto-upload":!1,"on-change":l.handleFileUpload,"show-file-list":!1},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(p,{type:"primary"},{default:Object(c["withCtx"])(()=>t[2]||(t[2]=[Object(c["createTextVNode"])("上传 Excel 文件")])),_:1})]),_:1},8,["on-change"])]),_:1})]),_:1}),Object(c["createVNode"])(f,null,{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(O,null,{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",r,[Object(c["createVNode"])(s,{size:"large",type:"info"},{default:Object(c["withCtx"])(()=>t[3]||(t[3]=[Object(c["createTextVNode"])("第二步")])),_:1})]),Object(c["createVNode"])(p,{type:"primary",onClick:t[0]||(t[0]=e=>l.mergeColumns(["所在省","所在市","收件地址"],"地址")),disabled:!l.tableData.length},{default:Object(c["withCtx"])(()=>t[4]||(t[4]=[Object(c["createTextVNode"])(' 合并 "所在省"、"所在市"、"收件地址" 列为 "地址" ')])),_:1},8,["disabled"])]),_:1})]),_:1}),Object(c["createVNode"])(f,null,{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(O,null,{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",u,[Object(c["createVNode"])(s,{size:"large",type:"info"},{default:Object(c["withCtx"])(()=>t[5]||(t[5]=[Object(c["createTextVNode"])("第三步")])),_:1})]),Object(c["createVNode"])(p,{onClick:l.keepColumns,type:"primary",disabled:!l.tableData.length},{default:Object(c["withCtx"])(()=>t[6]||(t[6]=[Object(c["createTextVNode"])("新系统格式更改表格")])),_:1},8,["onClick","disabled"])]),_:1})]),_:1}),Object(c["createVNode"])(f,null,{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(O,null,{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",d,[Object(c["createVNode"])(s,{size:"large",type:"info"},{default:Object(c["withCtx"])(()=>t[7]||(t[7]=[Object(c["createTextVNode"])("第四步")])),_:1})]),Object(c["createVNode"])(p,{type:"success",onClick:l.downloadExcel,disabled:!l.tableData.length},{default:Object(c["withCtx"])(()=>t[8]||(t[8]=[Object(c["createTextVNode"])(" 下载 Excel 表格 ")])),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),Object(c["createVNode"])(h,{data:l.tableData,style:{width:"100%","margin-top":"20px"},border:""},{default:Object(c["withCtx"])(()=>[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.tableHeaders,(e,t)=>(Object(c["openBlock"])(),Object(c["createBlock"])(v,{key:t,prop:e,label:e},null,8,["prop","label"]))),128))]),_:1},8,["data"])])}a("14d9"),a("2c66"),a("249d"),a("40e9"),a("e9f5"),a("910d"),a("7d54"),a("ab43"),a("907a"),a("986a"),a("1d02"),a("3c5d"),a("6ce5"),a("2834"),a("4ea1");var b=a("25ca"),s=a("3ef4"),p={setup(){const e=Object(c["ref"])([]),t=Object(c["ref"])([]),a=Object(c["ref"])(["订单编号","收件人姓名","联系电话","全部商品名称","商品属性","商品数量","物流方式1","物流单号1","物流方式2","物流单号2","物流方式3","物流单号3","物流方式4","物流单号4","地址"]),l=Object(c["ref"])(""),o=a=>{l.value=a.name;const c=new FileReader;c.onload=a=>{const c=new Uint8Array(a.target.result),l=b["a"](c,{type:"array"}),o=l.SheetNames[0],n=l.Sheets[o],r=b["b"].sheet_to_json(n,{header:1});r.length>0?(t.value=r[0],e.value=r.slice(1).map(e=>{const a={};return e.forEach((e,c)=>{a[t.value[c]]=e}),a}),s["a"].success("文件上传成功！")):s["a"].warning("文件内容为空！")},c.readAsArrayBuffer(a.raw)},n=(a,c)=>{const l=a.filter(e=>!t.value.includes(e));l.length>0?s["a"].warning("未找到列："+l.join(", ")):(e.value=e.value.map(e=>{const t=a.map(t=>e[t]).join(" ");return{...e,[c]:t}}),t.value=t.value.filter(e=>!a.includes(e)),t.value.push(c),e.value=e.value.map(e=>(a.forEach(t=>{delete e[t]}),e)),s["a"].success(`已将列 ${a.join(", ")} 合并为 ${c}`))},r=()=>{var c=JSON.parse(JSON.stringify(a.value));t.value=t.value.filter(e=>c.includes(e)),console.log(e,"tableDatatableData");var l=e.value.map(e=>{const t={};return c.forEach(a=>{void 0!==e[a]&&(t[a]=e[a])}),t});console.log(l),s["a"].success("只保留列："+c.join(", "))},u=()=>{if(e.value.length){const a=[t.value,...e.value.map(e=>t.value.map(t=>e[t]))],c=b["b"].book_new(),o=b["b"].aoa_to_sheet(a);b["b"].book_append_sheet(c,o,"Sheet1");const n=new Date,r=String(n.getMonth()+1).padStart(2,"0"),u=String(n.getDate()).padStart(2,"0"),d=`${r}.${u}`;b["c"](c,d+"新系统"+l.value),s["a"].success("文件下载成功！")}else s["a"].warning("请先上传 Excel 文件！")};return{tableData:e,tableHeaders:t,handleFileUpload:o,downloadExcel:u,keepColumns:r,mergeColumns:n}}},j=(a("7c80"),a("6b0d")),O=a.n(j);const f=O()(p,[["render",i],["__scopeId","data-v-da88d718"]]);var v=f,h={name:"App",components:{HelloWorld:v}};a("4682");const m=O()(h,[["render",l]]);var g=m,x=a("c3a1");a("7437");const y=Object(c["createApp"])(g);y.use(x["a"]),y.mount("#app")},"779e":function(e,t,a){},"7c80":function(e,t,a){"use strict";a("779e")},c78b:function(e,t,a){}});
//# sourceMappingURL=app.4611e4cb.js.map